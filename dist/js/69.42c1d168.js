"use strict";(self["webpackChunkbuaa_se_2022_summer"]=self["webpackChunkbuaa_se_2022_summer"]||[]).push([[69],{6069:function(e,t,s){s.r(t),s.d(t,{default:function(){return u}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"manage",attrs:{id:"manage"}},[t("el-container",[t("el-header",[t("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeIndex,mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"}},[t("el-menu-item",{attrs:{index:"1"},on:{click:e.showproj}},[e._v("项目中心")]),t("el-menu-item",{attrs:{index:"2"},on:{click:e.showrubbish}},[e._v("回收站")]),t("el-menu-item",{attrs:{index:"3"},on:{click:e.showAdd}},[e._v("新建项目")]),t("el-menu-item",{attrs:{index:"4"},on:{click:e.toManageTeam}},[e._v("管理团队")]),t("el-menu-item",{attrs:{index:"5","text-color":"#eb5451"}},[t("el-button",{attrs:{type:"text"},on:{click:e.logout}},[e._v("退出登陆")])],1)],1)],1),t("el-container",[t("el-main",[t("el-button",{attrs:{type:"text"},on:{click:e.newTeam}},[e._v("新建队伍")]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:16,offset:4}},[t("div",[t("el-collapse",{attrs:{accordion:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.teamlist,(function(s,a){return t("div",{key:s},[t("el-collapse-item",{attrs:{title:s,name:a}},[t("el-button",{attrs:{type:"success",plain:""},on:{click:function(t){return e.invite(a)}}},[e._v(" 邀请成员 ")]),e._l(e.userlist[a],(function(s,i){return t("div",{key:s},[t("el-divider"),e._v(" "+e._s(s)+" "),t("el-button",{staticClass:"right",attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.toManager(a,i)}}},[e._v("变更为管理员")]),t("el-button",{staticClass:"right",attrs:{size:"mini",type:"danger",plain:""},on:{click:function(t){return e.deleteUser(a,i)}}},[e._v("移出团队")])],1)})),e._l(e.managerlist[a],(function(s){return t("div",{key:s},[t("el-divider"),e._v(" "+e._s(s)+" "),t("el-button",{staticClass:"right",attrs:{size:"mini",type:"success",plain:"",disabled:""}},[e._v("管理员")])],1)}))],2)],1)})),0)],1)])],1)],1)],1)],1)],1)},i=[],r=s(5410),n=s.n(r),o={inject:["reload"],name:"ManageTeam",data(){return{activeIndex:"4",activeName:"1",teamlist:[],userlist:[],emaillist:[],managerlist:[]}},methods:{toManageTeam(){},logout(){this.$confirm("您即将退出登陆, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$message({type:"success",message:"退出成功!"}),this.$store.dispatch("clear"),this.$router.push("/login")})).catch((()=>{this.$message({type:"info",showClose:!0,message:"已放弃"})}))},showproj:function(){this.$router.push("/manageProject")},showrubbish:function(){this.$router.push("/manageRubbish")},showAdd:function(){this.$router.push("/addProject")},newTeam(){this.$prompt("请输入队伍名","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((({value:e})=>{const t=this.$store.state.userid;this.$axios({method:"post",url:"/createteam/",data:n().stringify({now_id:t,team_name:e})}).then((t=>{switch(t.data.result){case 0:this.$message.success("新建团队成功，团队名为:"+e),this.reload();break;case 1:this.$message.error("请求方式错误");break;case 2:this.$message.error("团队名已存在");break;case 3:this.$message.error("用户不存在");break}})).catch((e=>{console.log(e)}))})).catch((()=>{this.$message({type:"info",message:"取消输入"})}))},invite(e){this.$prompt("请输入被邀请成员的邮箱","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((({value:t})=>{var s=this;let a=this.$store.state.userid;this.$axios({method:"post",url:"/inviteuser/",data:n().stringify({now_userid:a,invite_useremail:t,teamname:s.teamlist[e]})}).then((e=>{switch(e.data.result){case 0:this.$message.success("添加成员成功"),this.reload();break;case 2:this.$message.error("不是管理员");break;case 3:this.$message.error("邀请用户不存在");break;case 4:this.$message.error("该用户已经在团队中");break}})).catch((e=>{console.log(e)}))})).catch((()=>{this.$message({type:"info",message:"取消输入"})}))},toManager(e,t){var s=this;let a=this.$store.state.userid;this.$axios({method:"post",url:"/setadmin/",data:n().stringify({id:a,teamname:s.teamlist[e],change_useremail:s.emaillist[e][t]})}).then((a=>{switch(a.data.result){case 0:this.$message.success("已提升"+s.emaillist[e][t]+"为管理员"),this.reload();break;case 1:this.$message.error("请求方式错误");break;case 2:this.$message.error("团队名已存在");break}})).catch((e=>{console.log(e)}))},deleteUser(e,t){var s=this;let a=this.$store.state.userid;this.$axios({method:"post",url:"/deleteuser/",data:n().stringify({now_userid:a,teamname:s.teamlist[e],delete_useremail:s.emaillist[e][t]})}).then((a=>{switch(a.data.result){case 0:this.$message.success("已移除"+s.emaillist[e][t]),this.reload();break;case 1:this.$message.error("请求方式错误");break}})).catch((e=>{console.log(e)}))}},mounted(){const e=this.$store.state.userid;let t=this;this.$axios({url:"/getteammember/",method:"post",data:n().stringify({now_id:e})}).then((e=>{switch(e.data.result){case 0:t.teamlist=e.data.team_list,t.userlist=e.data.big_list,t.emaillist=e.data.email_list;break}})),this.$axios({url:"/getteamadmin/",method:"post",data:n().stringify({now_id:e})}).then((e=>{switch(e.data.result){case 0:t.managerlist=e.data.big_list;break}}))},watch:{$router(){this.getData()}}},l=o,c=s(1001),m=(0,c.Z)(l,a,i,!1,null,"0aa65288",null),u=m.exports}}]);
//# sourceMappingURL=69.42c1d168.js.map